<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Stockholm University Demo</title>

  <link rel="stylesheet"  href="css/jquery.mobile-1.1.1.min.css" />
  <link rel="stylesheet"  href="css/mapapp.css" />

  <script src="cordova-2.0.0.js"></script>
  <script src="js/jquery-1.8.2.min.js"></script>
  <script src="js/jquery.mobile-1.1.1.min.js"></script>

  <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script src="js/jquery.ui.map/jquery.ui.map.js"></script>
  <script src="js/jquery.ui.map/jquery.ui.map.services.js"></script>
  <script src="js/mapapp.complete.js"></script>
  <script type="text/javascript" charset="utf-8" src="childbrowser.js"></script>

  <style>
    .ui-content {
      padding: 0;
    }

    .ui-grid-c > *:nth-child(n) {
      padding: 15px;
    }

    .ui-field-contain, .ui-mobile fieldset.ui-field-contain {
      margin: 0.2em 0;
    }

    .ui-field-contain label.ui-select {
      vertical-align: inherit;
      width: inherit;
    }

    div#page-map .ui-header .ui-btn-left, div#page-map .ui-header .ui-btn-right, div#page-map .ui-footer .ui-btn-left, div#page-map .ui-footer .ui-btn-right {
      top: inherit;
    }

    .ui-field-contain .ui-select {
      width: inherit;
      display: inline-block;
    }
  </style>
</head>
<body>

<div data-role="page" class="type-home" id="page-home" style="background-image: url(img/su-app-background.png);">
  <div data-role="content">
    <p class="jqm-version"></p>

    <!-- Home -->
    <div data-role="content" style="/*padding: 15px*/">
      <div class="ui-grid-c">
        <div class="ui-block-a">
          <a id="sukat_search_button" href="sukatsearch/index.html" data-ajax="false"><img src="img/icons/Address_Book.png"></a>
        </div>

        <div class="ui-block-b">
          <a href="#page-map"><img id="map-button" src="img/icons/maps.png"></a>
        </div>

        <div class="ui-block-c">
          <a onclick="ontap=openChildBrowser('https://mondo.su.se/portal/pda',null)"><img src="img/icons/mondo_button.png"></a>
        </div>

        <div class="ui-block-d">
          <a onclick="ontap=openChildBrowser('http://www-test.su.se',null)"><img src="img/icons/Web.png"></a>
        </div>

        <div class="ui-block-a">
          <a onclick="ontap=openChildBrowser('http://www.sub.su.se/mobil',null)"><img src="img/icons/Library.png"></a>
        </div>

        <div class="ui-block-b">
          <a href="#page-camera"><img src="img/icons/System.png"></a>
        </div>
      </div>
    </div>
  </div>
</div>

<div data-role="page" data-theme="a" data-fullscreen="true" id="page-map">

  <div data-theme="a" data-role="header" data-position="inline">
    <div data-role="fieldcontain">
      <select name="destination" id="destination">
        <option value="-">
          Destination
        </option>
        <option value="su-south">
          SU Södra
        </option>
        <option value="su-north">
          SU Norra
        </option>
        <option value="kraftriket">
          Kräftriket
        </option>
      </select>

      <div data-role="fieldcontain" style="position: absolute; top: -7px; left: 40%; margin: 0; padding: 0">
        <input name="" id="choosePOI" type="checkbox">
        <label for="choosePOI">POI</label>
      </div>

      <div data-role="fieldcontain" style="position: absolute; top: 0; right: 0; margin: 0; padding: 0">
        <a id="getDirections" data-role="button" data-transition="fade" href="javascript://nop"
           class="ui-btn-right" data-icon="search" data-iconpos="left">
          Directions
        </a>
      </div>
    </div>
  </div>

  <!-- Hidden until get to work with street view microformat -->
  <div class="vevent" style="display: none">
    <a href="#spinaltap" class="url summary">Spinal Tap</a>
			<span class="description">
				After their highly-publicized search for
				a new drummer, Spinal Tap kicks off their latest comeback tour with
				a San Francisco show.
			</span>
    When:
			<span class="dtstart"> 
				Oct 15,7:00PM<span class="value-title" title="2015-10-15T19:00-08:00"></span>
			</span>- 
			<span class="dtend"> 
				9:00PM<span class="value-title" title="2015-10-15T21:00-08:00"></span>
			</span>
    Where:
    <div class="location vcard">
      <span class="fn org">Warfield Theatre</span>,
				<span class="adr">
					<span class="street-address">982 Market St</span>, 
					<span class="locality">San Francisco</span>, 
					<span class="region">CA</span>
				</span> 
				<span class="geo"> 
					<span class="latitude"> 
						<span class="value-title" title="37.774929"></span>
					</span> 
					<span class="longitude"> 
						<span class="value-title" title="-122.419416"></span>
					</span>
				</span>
    </div>
  </div>

  <div data-role="content" id="map-content">
    <div id="map_canvas"></div>
  </div><!-- /content -->

  <div data-role="footer" data-theme="a" data-position="fixed" data-tap-toggle="false">
    <div data-role="navbar">
      <ul>
        <li><a href="#page-home">Home</a></li>
        <li><a href="#page-map" class="refresh">Refresh</a></li>
        <li><a href="#page-dir">Directions</a></li>
      </ul>
    </div><!-- /navbar -->
  </div><!-- /footer -->
</div><!-- /page-map -->

<div data-role="page" data-theme="a" data-fullscreen="true" id="page-dir">

  <div data-role="content">
    <div id="dir_panel"></div>
  </div><!-- /content -->

  <div data-role="footer" data-theme="a" data-position="fixed" data-tap-toggle="false">
    <div data-role="navbar">
      <ul>
        <li><a href="#page-home">Home</a></li>
        <li><a href="#page-map">Map</a></li>
      </ul>
    </div><!-- /navbar -->
  </div><!-- /footer -->
</div><!-- /page-dir -->

<script>
  $( document ).bind( "mobileinit", function() {
    // Make your jQuery Mobile framework configuration changes here!
    $.support.cors = true;
    $.mobile.allowCrossDomainPages = true;
  });
  $.mobile.pushStateEnabled=false;
  $.mobile.loadPage( 'sukatsearch/index.html', { showLoadMsg: true } );
  $.mobile.page.prototype.options.domCache = true;

  function openChildBrowser(url) {
    window.plugins.childBrowser.showWebPage(url, { showLocationBar: true });
    /*
     try {
     var childBrowser;
     childBrowser = new ChildBrowser();
     childBrowser.showWebPage(url);

     }
     catch (err)
     {
     alert(err);
     }
     */
  }

  window.plugins.childBrowser.onClose = function () {
    window.plugins.childBrowser.close();
  };
</script>

<div data-role="page"  data-fullscreen="true" id="page-camera">
  <div data-theme="a" data-role="header">
    <h3>Capture SU</h3>
    <a data-role="button" rel="external" data-ajax="false" data-transition="slide" href="../index.html" data-icon="arrow-l" data-iconpos="left" class="ui-btn-left">
      Back
    </a>
  </div>
  <div id="search_view" data-role="content">
    <button onclick="capturePhoto();">Capture Photo</button> <br>

    <!--
   <button onclick="capturePhotoEdit();">Capture Editable Photo</button> <br>
   <button onclick="getPhoto(pictureSource.PHOTOLIBRARY);">From Photo Library</button><br>
   <button onclick="getPhoto(pictureSource.SAVEDPHOTOALBUM);">From Photo Album</button><br>
    -->
    <img style="display:none;width:60px;height:60px;" id="smallImage" src="" />
    <img style="display:none;" id="largeImage" src="" />
  </div>
</div>

<script type="text/javascript" charset="utf-8">

  var pictureSource;   // picture source
  var destinationType; // sets the format of returned value

  // Wait for PhoneGap to connect with the device

  document.addEventListener("deviceready",onDeviceReady,false);

  // PhoneGap is ready to be used!
  //
  function onDeviceReady() {
    pictureSource=navigator.camera.PictureSourceType;
    destinationType=navigator.camera.DestinationType;
  }

  // Called when a photo is successfully retrieved
  //
  function onPhotoDataSuccess(imageData) {
    setImagePathVariable(imageData);
    $.mobile.changePage($("#page-map"));
  }

  function capturePhoto() {
    navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50 });
  }

  // Called if something bad happens.
  function onFail(message) {
    alert('Failed because: ' + message);
  }

  function setImagePathVariable(variable)
  {
    window.imagePath = variable;
  }

  function getImagePathVariable()
  {
    return(window.imagePath);
  }
</script>
</body>
</html>
